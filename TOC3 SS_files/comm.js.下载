const { Common, Ajax, LOLAPP } = LOL;

var $ = JQ = jQuery.noConflict(true);
// 弹窗
function TGDialogS(e) {
  need("biz.dialog-min", function (Dialog) {
    Dialog.show({
      id: e,
      bgcolor: '#000', //弹出“遮罩”的颜色，格式为"#FF6600"，可修改，默认为"#fff"
      opacity: 50      //弹出“遮罩”的透明度，格式为｛10-100｝，可选
    });
  });
}
function closeDialog() {
  need("biz.dialog-min", function (Dialog) {
    Dialog.hide();
  });
}
//视频弹窗
function popVideo(vid){
  var player = new Txplayer({
      containerId: 'video-play',
      vid: vid,
      width: '100%',
      height: '100%',
      autoplay: true
  });
  if (liveVideo) {
    liveVideo.pause();
  }
  TGDialogS('popVideo')
}
function closeVideo(){
  closeDialog();
  $('#video-play').html(' ');
}
//侧导航
function initRightNav() {
  $('.right-nav-toggle').click(function () {
    $(this).hide();
    $('.right-nav').show().removeClass('fhide')
  })
  $('.right-nav a.right-nav-hide').click(function(){
    $('.right-nav-toggle').show();
    $('.right-nav').hide().addClass('fhide')
  })
  $(document).scroll(function () {
    if ($('.right-nav').hasClass('fhide')) {
      return
    }
    var _top = $(document).scrollTop();

    if (_top >= 960) {
      $('.right-nav').fadeIn();
    } else {
      $('.right-nav').fadeOut();
    }
  });
}

// 判断双端环境加载对应脚本
if (Common.isPC()) {
  // PC端执行
  Ajax.seriesLoadScripts([
      { src: '//ossweb-img.qq.com/images/lol/title/lol.js', charset: 'gbk' }
  ])
      .then(() => {
        initRightNav();
      })
      .catch(e => console.log(e))
} else {
  // 移动端执行
  // 初始化分享
  const sharePrimary = () => {
      // QTLTools.SetTitle('第三届《英雄联盟 云顶之弈》公开赛')
      QTLTools.SetShare({
          url: location.href,
          title: '剑指云巅！第三届《英雄联盟 云顶之弈》公开赛！',
          content: '百万奖金，全民参与，赏金好礼，就在TOC 3 第三届《英雄联盟 云顶之弈》公开赛！',
          thumb_url: 'https://game.gtimg.cn/images/lpl/act/a20220310toc/shareicon.png',
          callback: function(channel) {
              console.log('点击了原生分享:', channel);
              switch (channel) {
                  case 'wx_appmessage':
                      PTTSendClick('btn', 'sharewx', '分享给好友');
                      break;
                  case 'wx_timeline':
                      PTTSendClick('btn', 'sharewx_timeline', '分享到朋友圈');
                      break;
                  case 'qq_appmessage':
                      PTTSendClick('btn', 'shareqq', '分享到QQ');
                      break;
                  case 'qq_qzone':
                      PTTSendClick('btn', 'shareqq_qzone', '分享到QQ空间');
                      break;
                  default:
                      break;
              }

          },
      })
  }
  LOLAPP.initAPP()
      .then(() => {
          sharePrimary();
          setTimeout(() => {
              sharePrimary();
          }, 5000);
      })
      .catch(e => console.log(e))

  // Ajax.seriesLoadScripts([
  // ])
  //     .then(() => console.log('移动端脚本加载完成'))
  //     .catch(e => console.log(e))
}